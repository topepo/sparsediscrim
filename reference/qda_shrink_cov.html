<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Shrinkage-based Diagonal Quadratic Discriminant Analysis (SDQDA) — qda_shrink_cov • sparsediscrim</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Shrinkage-based Diagonal Quadratic Discriminant Analysis (SDQDA) — qda_shrink_cov" />
<meta property="og:description" content="Given a set of training data, this function builds the Shrinkage-based
Diagonal Quadratic Discriminant Analysis (SDQDA) classifier, which is based
on the DQDA classifier, often attributed to Dudoit et al. (2002). The DQDA
classifier belongs to the family of Naive Bayes classifiers, where the
distributions of each class are assumed to be multivariate normal. To improve
the estimation of the class variances, Pang et al. (2009) proposed the SDQDA
classifier which uses a shrinkage-based estimators of each class covariance
matrix.
The SDQDA classifier is a modification to QDA, where the off-diagonal
elements of the pooled sample covariance matrix are set to zero. To improve
the estimation of the pooled variances, we use a shrinkage method from Pang
et al.  (2009)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sparsediscrim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.5.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/topepo/sparsediscrim/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Shrinkage-based Diagonal Quadratic Discriminant Analysis (SDQDA)</h1>
    <small class="dont-index">Source: <a href='https://github.com/topepo/sparsediscrim/blob/master/R/qda-shrink-cov.r'><code>R/qda-shrink-cov.r</code></a></small>
    <div class="hidden name"><code>qda_shrink_cov.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given a set of training data, this function builds the Shrinkage-based
Diagonal Quadratic Discriminant Analysis (SDQDA) classifier, which is based
on the DQDA classifier, often attributed to Dudoit et al. (2002). The DQDA
classifier belongs to the family of Naive Bayes classifiers, where the
distributions of each class are assumed to be multivariate normal. To improve
the estimation of the class variances, Pang et al. (2009) proposed the SDQDA
classifier which uses a shrinkage-based estimators of each class covariance
matrix.</p>
<p>The SDQDA classifier is a modification to QDA, where the off-diagonal
elements of the pooled sample covariance matrix are set to zero. To improve
the estimation of the pooled variances, we use a shrinkage method from Pang
et al.  (2009).</p>
    </div>

    <pre class="usage"><span class='fu'>qda_shrink_cov</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for default</span>
<span class='fu'>qda_shrink_cov</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, prior <span class='op'>=</span> <span class='cn'>NULL</span>, num_alphas <span class='op'>=</span> <span class='fl'>101</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for formula</span>
<span class='fu'>qda_shrink_cov</span><span class='op'>(</span><span class='va'>formula</span>, <span class='va'>data</span>, prior <span class='op'>=</span> <span class='cn'>NULL</span>, num_alphas <span class='op'>=</span> <span class='fl'>101</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for qda_shrink_cov</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>newdata</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>Matrix or data frame containing the training data. The rows are the
sample observations, and the columns are the features. Only complete data are
retained.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>Vector of class labels for each training observation. Only complete
data are retained.</p></td>
    </tr>
    <tr>
      <th>prior</th>
      <td><p>Vector with prior probabilities for each class. If NULL
(default), then equal probabilities are used. See details.</p></td>
    </tr>
    <tr>
      <th>num_alphas</th>
      <td><p>the number of values used to find the optimal amount of
shrinkage</p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>A formula of the form <code>groups ~ x1 + x2 + ...</code> That is,
the response is the grouping factor and the right hand side specifies the
(non-factor) discriminators.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>data frame from which variables specified in <code>formula</code> are
preferentially to be taken.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>Fitted model object</p></td>
    </tr>
    <tr>
      <th>newdata</th>
      <td><p>Matrix or data frame of observations to predict. Each row
corresponds to a new observation.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>qda_shrink_cov</code> object that contains the trained SDQDA classifier</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The DQDA classifier is a modification to the well-known QDA classifier, where
the off-diagonal elements of the pooled covariance matrix are assumed to be
zero -- the features are assumed to be uncorrelated. Under multivariate
normality, the assumption uncorrelated features is equivalent to the
assumption of independent features. The feature-independence assumption is a
notable attribute of the Naive Bayes classifier family. The benefit of these
classifiers is that they are fast and have much fewer parameters to estimate,
especially when the number of features is quite large.</p>
<p>The matrix of training observations are given in <code>x</code>. The rows of
<code>x</code> contain the sample observations, and the columns contain the
features for each training observation.</p>
<p>The vector of class labels given in <code>y</code> are coerced to a <code>factor</code>.
The length of <code>y</code> should match the number of rows in <code>x</code>.</p>
<p>An error is thrown if a given class has less than 2 observations because the
variance for each feature within a class cannot be estimated with less than 2
observations.</p>
<p>The vector, <code>prior</code>, contains the <em>a priori</em> class membership for
each class. If <code>prior</code> is NULL (default), the class membership
probabilities are estimated as the sample proportion of observations
belonging to each class. Otherwise, <code>prior</code> should be a vector with the
same length as the number of classes in <code>y</code>. The <code>prior</code>
probabilities should be nonnegative and sum to one.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Dudoit, S., Fridlyand, J., &amp; Speed, T. P. (2002). "Comparison of
Discrimination Methods for the Classification of Tumors Using Gene Expression
Data," Journal of the American Statistical Association, 97, 457, 77-87.</p>
<p>Pang, H., Tong, T., &amp; Zhao, H. (2009). "Shrinkage-based Diagonal
Discriminant Analysis and Its Applications in High-Dimensional Data,"
Biometrics, 65, 4, 1021-1029.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>42</span><span class='op'>)</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>)</span>
<span class='va'>train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>, <span class='va'>n</span> <span class='op'>/</span> <span class='fl'>2</span><span class='op'>)</span>
<span class='va'>sdqda_out</span> <span class='op'>&lt;-</span> <span class='fu'>qda_shrink_cov</span><span class='op'>(</span><span class='va'>Species</span> <span class='op'>~</span> <span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>iris</span><span class='op'>[</span><span class='va'>train</span>, <span class='op'>]</span><span class='op'>)</span>
<span class='va'>predicted</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>sdqda_out</span>, <span class='va'>iris</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span>, <span class='op'>-</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span><span class='op'>$</span><span class='va'>class</span>

<span class='va'>sdqda_out2</span> <span class='op'>&lt;-</span> <span class='fu'>qda_shrink_cov</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>iris</span><span class='op'>[</span><span class='va'>train</span>, <span class='op'>-</span><span class='fl'>5</span><span class='op'>]</span>, y <span class='op'>=</span> <span class='va'>iris</span><span class='op'>[</span><span class='va'>train</span>, <span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>predicted2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>sdqda_out2</span>, <span class='va'>iris</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span>, <span class='op'>-</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span><span class='op'>$</span><span class='va'>class</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>predicted</span>, <span class='va'>predicted2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Max Kuhn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


